import{_ as e,r as t,b as a,i as s,c as l,a as i,f as o,F as n,d as c,t as r,u as d,o as u,e as v,j as m,h as p,n as g,k as f}from"./index.CIxDUkZG.js";import{_ as h}from"./macaron_yellow_rgb.DN6hcqoj.js";const S={class:"qing-male-index"},T={class:"main-content"},I={class:"recent-orders"},b={class:"order-list"},x={class:"order-header"},O=["onUpdate:modelValue","onChange"],w={class:"order-content"},y={class:"order-dish"},_={class:"order-time"},j={class:"order-price"},k={key:0,class:"custom-confirm"},C={class:"owed-counter"},D={class:"counter-value"},$=e({__name:"index",setup(e){d(),t(5),t(20),t("4.8");const $=t([]),E=t(!1),q=t({}),N=t(null);a(()=>{$.value.forEach(e=>{q.value[e.id]="pending"})});const J=s(()=>{const e=(new Date).toISOString().split("T")[0];return $.value.filter(t=>new Date(t.createTime).toISOString().split("T")[0]===e).length});a(()=>{console.log("清宫男厨师端首页加载"),(()=>{const e=localStorage.getItem("femaleOrders");if(e){const t=JSON.parse(e),a=[];t.forEach(e=>{e.items.forEach(t=>{for(let s=0;s<t.quantity;s++)a.push({id:`${e.id}-${t.id}-${s}`,name:t.name,status:e.status,statusText:e.statusText,createTime:e.createTime,time:new Date(e.createTime).toLocaleString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),price:t.price})})}),$.value=a,setTimeout(()=>{$.value.forEach(e=>{q.value[e.id]="pending"})},0)}})(),console.log("当前日期:",(new Date).toISOString().split("T")[0]),console.log("所有菜品:",$.value),console.log("当天已完成菜品:",$.value.filter(e=>{const t=new Date(e.createTime).toISOString().split("T")[0];return"completed"===e.status&&t===(new Date).toISOString().split("T")[0]}))});const P=()=>{N.value&&N.value.name&&(navigator.clipboard.writeText(N.value.name).then(()=>{console.log("菜肴名称已复制到剪贴板:",N.value.name)}).catch(e=>{console.error("复制失败:",e)}),V(N.value)),E.value=!1,N.value=null},U=()=>{N.value&&V(N.value),E.value=!1,N.value=null},V=e=>{const t=localStorage.getItem("femaleOrders");if(t){let a=JSON.parse(t);const s=$.value.filter(t=>t.id!==e.id);$.value=s;const[l,i,o]=e.id.split("-"),n=a.findIndex(e=>e.id===l);if(-1!==n){const e=a[n],t=e.items.findIndex(e=>e.id===i);-1!==t&&(e.items[t].quantity>1?(e.items[t].quantity--,e.totalItems--,e.totalPrice=`${e.totalItems}个亲亲`):(e.items.splice(t,1),e.totalItems--,e.totalPrice=`${e.totalItems}个亲亲`,0===e.items.length&&a.splice(n,1)),localStorage.setItem("femaleOrders",JSON.stringify(a)))}$.value.forEach(e=>{q.value[e.id]=e.status})}};return(e,t)=>(u(),l("div",S,[t[7]||(t[7]=i("div",{class:"custom-navbar"},[i("div",{class:"nav-left"}),i("div",{class:"nav-right"})],-1)),i("div",T,[i("div",I,[t[3]||(t[3]=i("h2",{class:"section-title"},"小主旨意",-1)),i("div",b,[(u(!0),l(n,null,c($.value,e=>(u(),l("div",{class:"order-item",key:e.id},[i("div",x,[v(i("select",{class:g(["order-status-select",q.value[e.id]]),"onUpdate:modelValue":t=>q.value[e.id]=t,onChange:t=>(e=>{const t={pending:"待处理",processing:"制作中",completed:"已完成",rejected:"驳回/删除"},a=q.value[e.id];"rejected"===a?(N.value=e,E.value=!0,q.value[e.id]=e.status):(e.status=a,e.statusText=t[a],console.log(`菜品状态已更新为${e.statusText}`))})(e),onClick:t[0]||(t[0]=p(()=>{},["stop"]))},[...t[1]||(t[1]=[i("option",{value:"pending"},"待处理",-1),i("option",{value:"processing"},"制作中",-1),i("option",{value:"completed"},"已完成",-1),i("option",{value:"rejected"},"驳回/删除",-1)])],42,O),[[m,q.value[e.id]]])]),i("div",w,[i("span",y,r(e.name),1),i("span",_,r(e.time),1)]),i("div",j,[t[2]||(t[2]=i("img",{src:h,alt:"马卡龙黄色",class:"price-icon"},null,-1)),f(" "+r(e.price),1)])]))),128))])])]),E.value?(u(),l("div",k,[i("div",{class:"confirm-content"},[t[4]||(t[4]=i("p",{class:"confirm-text"},"菜菜：你不要菜菜了吗？",-1)),i("div",{class:"confirm-buttons"},[i("button",{class:"confirm-btn reject-btn",onClick:P},"驳回"),i("button",{class:"confirm-btn delete-btn",onClick:U},"删除")])])])):o("",!0),i("div",C,[t[5]||(t[5]=i("img",{class:"counter-icon",src:h,alt:"马卡龙黄色"},null,-1)),t[6]||(t[6]=i("span",{class:"counter-text"},"已欠亲亲",-1)),i("span",D,r(J.value),1)])]))}},[["__scopeId","data-v-7b72641b"]]);export{$ as default};
