import{_ as e,r as a,w as l,b as s,d as o,c as t,a as n,e as c,F as i,f as r,g as u,v as d,n as v,t as g,u as m,o as p,h as y,i as f}from"./index.D0pGnVOK.js";import{_ as h}from"./macaron_yellow_rgb.DN6hcqoj.js";import{i as k,g as w}from"./data.FeRZri8D.js";import{getFeishuTableUpdateTime as C,addFeishuOrder as b}from"./feishuApi.BtMD_xKQ.js";let q=null;const S=async()=>{console.log("å¼€å§‹åŠ è½½èœå“æ•°æ®..."),await k();const e=w();console.log("è¿”å›èœå“æ•°æ®ï¼Œå…±",e.length,"æ¡");const a=await C();return a&&(q=a),e},x={class:"qing-female-index"},D={class:"particles-container"},I={key:0,class:"update-notification"},$={key:1,class:"updating-notification"},_={class:"main-content"},L={class:"search-bar"},O={class:"search-input"},M={class:"category-container"},J={class:"category-scroll"},N=["onClick"],j={class:"category-text"},T={key:0,class:"subcategory-dropdown"},U=["onClick"],E={class:"subcategory-text"},A={class:"waterfall-container"},z={class:"card-content"},B=["src","onError"],F={class:"dish-info"},P={class:"dish-name"},R={class:"dish-description"},V={class:"dish-footer"},Z={class:"dish-price"},G={class:"price-text"},H=["onClick"],K={key:0,class:"cart-badge"},Q={key:0,class:"cart-empty"},W={key:1,class:"cart-items"},X={class:"item-image"},Y=["src","alt"],ee={class:"item-info"},ae={class:"item-name"},le={class:"item-price"},se={class:"item-actions"},oe=["onClick"],te={class:"quantity"},ne=["onClick"],ce={key:2,class:"cart-footer"},ie={class:"total-info"},re={class:"total-price"},ue=e({__name:"index",setup(e){const w=m(),ue=a([]),de=a([]),ve=a([[],[]]),ge=a(""),me=a("ä¸»é£Ÿ"),pe=a("all"),ye=a(null),fe=a([]),he=a(!1),ke=a(!1),we=a(!1),Ce=a([]),be=a(0),qe=a(!1);let Se=null;l(Ce,()=>{localStorage.setItem("femaleCart",JSON.stringify(Ce.value)),console.log("è´­ç‰©è½¦æ•°æ®å·²ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨")},{deep:!0});const xe=a([{name:"ä¸»é£Ÿ"},{name:"ç´ èœ"},{name:"è¤èœ"},{name:"å…¶ä»–"}]),De=a(new Map),Ie=e=>{const a=`${e.category} ${e.subCategory} ${e.name}`.toLowerCase();return["æµ·é²œ","é±¼","è™¾","èŸ¹","è´","èº","é²","å‚","è›","è›¤","è›","é±¿","ç« é±¼","å¢¨é±¼","æµ·èœ‡","æµ·å¸¦","ç´«èœ","æµ·è—»"].some(e=>a.includes(e))},$e=()=>{const e=new Map;ue.value.forEach(a=>{let l=a.category,s=a.subCategory;"æ±¤"===l?(l="å…¶ä»–",s="æ±¤"):(Ie(a)||"æµ·é²œ"===l)&&(l="å…¶ä»–",s="é±¼é²œ"),e.has(l)||e.set(l,new Set),e.get(l).add(s)}),De.value=e},_e=async()=>{try{ke.value=!0,we.value=!1;if(await(async()=>{console.log("======== æ£€æŸ¥é£ä¹¦è¡¨æ ¼æ›´æ–° ========");try{console.log("1. è·å–å½“å‰é£ä¹¦è¡¨æ ¼æ›´æ–°æ—¶é—´...");const e=await C();return e?(console.log("2. å½“å‰é£ä¹¦è¡¨æ ¼æ›´æ–°æ—¶é—´:",e),console.log("3. ä¸Šæ¬¡æ›´æ–°æ—¶é—´:",q),!q||e>q?(console.log("4. æ£€æµ‹åˆ°é£ä¹¦è¡¨æ ¼æ›´æ–°ï¼Œå¼€å§‹é‡æ–°åŠ è½½æ•°æ®..."),await k(),q=e,console.log("5. æ•°æ®é‡æ–°åŠ è½½å®Œæˆï¼Œä¸Šæ¬¡æ›´æ–°æ—¶é—´å·²æ›´æ–°ä¸º:",q),console.log("=============================="),!0):(console.log("4. é£ä¹¦è¡¨æ ¼æœªæ›´æ–°ï¼Œæ£€æŸ¥ç»“æŸ"),console.log("=============================="),!1)):(console.log("2. æ— æ³•è·å–é£ä¹¦è¡¨æ ¼æ›´æ–°æ—¶é—´ï¼Œæ£€æŸ¥ç»“æŸ"),console.log("=============================="),!1)}catch(e){return console.error("æ£€æŸ¥é£ä¹¦è¡¨æ ¼æ›´æ–°å¤±è´¥:",e),console.log("=============================="),!1}})()){console.log("æ£€æµ‹åˆ°é£ä¹¦è¡¨æ ¼æ›´æ–°ï¼Œé‡æ–°åŠ è½½èœå“æ•°æ®...");const e=await S();ue.value=e,$e(),je(ge.value,me.value,pe.value),we.value=!0,console.log("èœå“æ•°æ®å·²æ›´æ–°"),setTimeout(()=>{we.value=!1},3e3)}}catch(e){console.error("å¤„ç†æ›´æ–°å¤±è´¥:",e)}finally{ke.value=!1}},Le=()=>{Se&&(console.log("======== åœæ­¢é£ä¹¦è¡¨æ ¼è½®è¯¢ ========"),console.log("åœæ­¢è½®è¯¢å®šæ—¶å™¨ï¼ŒID:",Se),clearInterval(Se),Se=null,console.log("è½®è¯¢å·²åœæ­¢"),console.log("=============================="))};s(()=>{Oe(),Me(),(()=>{const e=localStorage.getItem("femaleCart");e&&(Ce.value=JSON.parse(e),Te(),console.log("ä»æœ¬åœ°å­˜å‚¨åŠ è½½è´­ç‰©è½¦æ•°æ®:",Ce.value))})(),console.log("======== å¯åŠ¨é£ä¹¦è¡¨æ ¼è½®è¯¢ ========"),console.log("è½®è¯¢é—´éš”:",30,"ç§’"),Le(),Se=setInterval(_e,3e4),console.log("è½®è¯¢å®šæ—¶å™¨ID:",Se),console.log("==============================")}),o(()=>{Le()});const Oe=()=>{const e=[];for(let a=0;a<30;a++)e.push({left:100*Math.random(),top:100*Math.random(),delay:2e3*Math.random(),duration:4e3+2e3*Math.random()});fe.value=e},Me=async()=>{console.log("å¼€å§‹åŠ è½½èœå“æ•°æ®..."),he.value=!0;try{console.log("è°ƒç”¨loadDishDataå‡½æ•°...");const e=await S();console.log("åŠ è½½èœå“æ•°æ®æˆåŠŸï¼Œå…±åŠ è½½åˆ°",e.length,"æ¡æ•°æ®"),ue.value=e,console.log("allDishes.valueèµ‹å€¼å®Œæˆï¼Œé•¿åº¦:",ue.value.length),$e(),console.log("äºŒçº§åˆ†ç±»æ˜ å°„åˆå§‹åŒ–å®Œæˆ"),je(ge.value,me.value,pe.value),he.value=!1,console.log("åŠ è½½èœå“æ•°æ®å®Œæˆ")}catch(e){console.error("åŠ è½½èœå“æ•°æ®å¤±è´¥:",e),he.value=!1}},Je=e=>{pe.value=e,je(ge.value,me.value,e),ye.value=null},Ne=e=>{me.value=e,pe.value="all",je(ge.value,e,"all")};l(ge,e=>{je(e,"","all")});const je=(e,a,l)=>{let s=[...ue.value];if(a&&(s="å…¶ä»–"===a?s.filter(e=>{const a="æ±¤"===e.category,l="æµ·é²œ"===e.category,s=Ie(e);return a||l||s}):s.filter(e=>e.category===a),"all"!==l&&("å…¶ä»–"===a?"é±¼é²œ"===l?s=s.filter(e=>"æµ·é²œ"===e.category||Ie(e)):"æ±¤"===l&&(s=s.filter(e=>"æ±¤"===e.category)):s=s.filter(e=>e.subCategory===l))),e&&e.trim()){const a=e.toLowerCase();s=ue.value.filter(e=>e.name&&e.name.toLowerCase().includes(a)||e.description&&e.description.toLowerCase().includes(a)||e.ingredients&&e.ingredients.some(e=>e&&e.toLowerCase().includes(a)))}const o=new Map,t=s.filter(e=>{const a=e.name.toLowerCase().replace(/[ç‚–ç…®ç‚’ç‚¸çƒ§ç„–ç…çƒ¤è’¸çƒ©æ‹Œ]/g," ").split("").sort().join("");return!o.has(a)&&(o.set(a,e),!0)});de.value=t,console.log("æœç´¢å…³é”®è¯:",e,"åŸæ•°æ®é•¿åº¦:",s.length,"å»é‡åé•¿åº¦:",t.length),(e=>{const a=[[],[]];e.forEach((e,l)=>{a[l%2].push(e)}),ve.value=a})(t)},Te=()=>{be.value=Ce.value.reduce((e,a)=>e+a.quantity,0)},Ue=()=>{qe.value=!qe.value,console.log("è´­ç‰©è½¦é¢æ¿çŠ¶æ€:",qe.value)},Ee=(e,a)=>{const l=e.quantity+a;if(l<=0){const a=Ce.value.findIndex(a=>a.id===e.id);a>-1&&Ce.value.splice(a,1)}else e.quantity=l;Te(),console.log("æ›´æ–°å•†å“æ•°é‡:",e.name,"æ–°æ•°é‡:",l)},Ae=async()=>{if(0===be.value)return void console.log("è´­ç‰©è½¦ä¸ºç©ºï¼Œæ— æ³•ä¸‹å•");const e={id:"ORD"+Date.now().toString().slice(-8),createTime:Date.now(),status:"completed",statusText:"å·²å®Œæˆ",items:Ce.value.map(e=>({id:e.id,name:e.name,price:e.price,quantity:e.quantity})),totalItems:be.value,totalPrice:`${be.value}ä¸ªäº²äº²`};console.log("ç”Ÿæˆè®¢å•:",e);const a=localStorage.getItem("femaleOrders");let l=[];a&&(l=JSON.parse(a)),l.unshift(e),localStorage.setItem("femaleOrders",JSON.stringify(l)),console.log("è®¢å•å·²ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨:",e);for(const o of Ce.value)for(let e=0;e<o.quantity;e++)try{await b({name:o.name,createTime:(new Date).toLocaleString("zh-CN",{timeZone:"Asia/Shanghai"}),status:"pending"}),console.log(`å·²å‘é£ä¹¦è¡¨æ ¼æ·»åŠ è®°å½•: ${o.name}`)}catch(s){console.error("å‘é£ä¹¦è¡¨æ ¼æ·»åŠ è®°å½•å¤±è´¥:",s)}Ce.value=[],Te(),qe.value=!1,w.push("/royal-seal"),console.log("ä¸‹å•æˆåŠŸï¼Œå·²è·³è½¬åˆ°å†å²è®¢å•é¡µé¢")};return(e,a)=>{return p(),t("div",x,[n("div",D,[(p(!0),t(i,null,r(fe.value,(e,a)=>(p(),t("div",{key:a,class:"particle",style:y({left:`${e.left}%`,top:`${e.top}%`,animationDelay:`${e.delay}ms`,animationDuration:`${e.duration}ms`})},null,4))),128))]),we.value?(p(),t("div",I," æ•°æ®å·²æ›´æ–°ï¼Œå±•ç¤ºæœ€æ–°èœè‚´ï¼ ")):c("",!0),ke.value?(p(),t("div",$," æ£€æŸ¥æ›´æ–°ä¸­... ")):c("",!0),a[9]||(a[9]=n("div",{class:"custom-navbar"},[n("div",{class:"nav-right"})],-1)),n("div",_,[n("div",L,[n("div",O,[a[2]||(a[2]=n("img",{class:"search-icon",src:"/qingqing/assets/design_icon.Br84S2zd.png",alt:"æœç´¢å›¾æ ‡"},null,-1)),u(n("input",{type:"text",placeholder:"æœç´¢èœå“",class:"search-placeholder","onUpdate:modelValue":a[0]||(a[0]=e=>ge.value=e)},null,512),[[d,ge.value]])])]),n("div",M,[n("div",J,[(p(!0),t(i,null,r(xe.value,e=>(p(),t("div",{key:e.name,class:v(["category-item",{selected:me.value===e.name}]),onClick:a=>(e=>{ye.value===e?ye.value=null:(ye.value=e,pe.value="all",Ne(e))})(e.name)},[n("span",j,g(e.name),1),n("span",{class:v(["dropdown-arrow",{rotated:ye.value===e.name}])},"â–¼",2)],10,N))),128))]),ye.value?(p(),t("div",T,[n("div",{class:v(["subcategory-item",{selected:"all"===pe.value}]),onClick:a[1]||(a[1]=e=>Je("all"))},[...a[3]||(a[3]=[n("span",{class:"subcategory-text"},"å…¨éƒ¨",-1)])],2),(p(!0),t(i,null,r((l=ye.value,Array.from(De.value.get(l)||[])),e=>(p(),t("div",{key:e,class:v(["subcategory-item",{selected:pe.value===e}]),onClick:a=>Je(e)},[n("span",E,g(e),1)],10,U))),128))])):c("",!0)]),n("div",A,[(p(!0),t(i,null,r(ve.value,(e,l)=>(p(),t("div",{class:"waterfall-column",key:l},[(p(!0),t(i,null,r(e,e=>(p(),t("div",{class:"dish-card",key:e.id},[a[6]||(a[6]=n("div",{class:"card-background"},null,-1)),n("div",z,[n("img",{class:"dish-image",src:e.imageUrl,alt:"dish.name",onError:a=>((e,a)=>{console.error(`å›¾ç‰‡åŠ è½½å¤±è´¥: ${JSON.stringify(a.imageUrl)}`),e.target.src=`https://picsum.photos/200/200?random=${a.id}`,a.imageUrl=e.target.src})(a,e)},null,40,B),n("div",F,[n("span",P,g(e.name),1),n("span",R,g(e.description),1),n("div",V,[n("div",Z,[a[4]||(a[4]=n("img",{class:"price-icon",src:h,alt:"é©¬å¡é¾™é»„è‰²"},null,-1)),n("span",G,g(e.price),1)]),n("div",{class:"add-to-cart-btn",onClick:f(a=>(e=>{const a=Ce.value.find(a=>a.id===e.id);a?a.quantity+=1:Ce.value.push({...e,quantity:1}),Te(),console.log("æ·»åŠ åˆ°è´­ç‰©è½¦æˆåŠŸ:",e.name,"è´­ç‰©è½¦æ•°é‡:",be.value)})(e),["stop"])},[...a[5]||(a[5]=[n("img",{class:"add-icon",src:"/qingqing/assets/design_icon_2.kJTLLqaS.png",alt:"æ·»åŠ åˆ°è´­ç‰©è½¦"},null,-1)])],8,H)])])])]))),128))]))),128))])]),n("div",{class:"fab",onClick:Ue},[be.value>0?(p(),t("div",K,g(be.value),1)):c("",!0)]),n("div",{class:v(["cart-panel",{expanded:qe.value}])},[n("div",{class:"cart-header"},[a[7]||(a[7]=n("h3",null,"æˆ‘çš„è´­ç‰©è½¦",-1)),n("span",{class:"close-btn",onClick:Ue},"Ã—")]),0===be.value?(p(),t("div",Q,[...a[8]||(a[8]=[n("span",{class:"empty-icon"},"ğŸ›’",-1),n("p",null,"è´­ç‰©è½¦æ˜¯ç©ºçš„ï¼Œå¿«å»æ·»åŠ ç¾é£Ÿå§ï½",-1)])])):(p(),t("div",W,[(p(!0),t(i,null,r(Ce.value,e=>(p(),t("div",{key:e.id,class:"cart-item"},[n("div",X,[n("img",{src:e.imageUrl,alt:e.name},null,8,Y)]),n("div",ee,[n("h4",ae,g(e.name),1),n("p",le,g(e.price),1)]),n("div",se,[n("button",{class:"action-btn decrease",onClick:a=>Ee(e,-1)},"-",8,oe),n("span",te,g(e.quantity),1),n("button",{class:"action-btn increase",onClick:a=>Ee(e,1)},"+",8,ne)])]))),128))])),be.value>0?(p(),t("div",ce,[n("div",ie,[n("span",null,"å…± "+g(be.value)+" ä»¶å•†å“",1),n("span",re,"æ€»è®¡ï¼š"+g(be.value)+" ä¸ªäº²äº²",1)]),n("button",{class:"checkout-btn",onClick:Ae},"ä¸‹å•")])):c("",!0)],2)]);var l}}},[["__scopeId","data-v-209f3c98"]]);export{ue as default};
