import{_ as e,r as a,w as l,b as s,d as o,c as t,a as n,e as c,F as i,f as r,g as u,v as d,n as v,t as g,u as m,o as p,h as y,i as f}from"./index.DcWu3WZk.js";import{_ as h}from"./macaron_yellow_rgb.CYgVi2W7.js";import{i as k,g as w}from"./data.DmP2Cwku.js";import{getFeishuTableUpdateTime as C,addFeishuOrder as b}from"./feishuApi.C5khGGHD.js";const S=""+new URL("design_icon.Br84S2zd.png",import.meta.url).href,q=""+new URL("design_icon_2.kJTLLqaS.png",import.meta.url).href;let x=null;const D=async()=>{console.log("å¼€å§‹åŠ è½½èœå“æ•°æ®..."),await k();const e=w();console.log("è¿”å›èœå“æ•°æ®ï¼Œå…±",e.length,"æ¡");const a=await C();return a&&(x=a),e},I={class:"qing-female-index"},L={class:"particles-container"},$={key:0,class:"update-notification"},_={key:1,class:"updating-notification"},O={class:"main-content"},M={class:"search-bar"},U={class:"search-input"},J={class:"category-container"},N={class:"category-scroll"},j=["onClick"],T={class:"category-text"},E={key:0,class:"subcategory-dropdown"},A=["onClick"],R={class:"subcategory-text"},z={class:"waterfall-container"},B={class:"card-content"},F=["src","onError"],P={class:"dish-info"},V={class:"dish-name"},Z={class:"dish-description"},G={class:"dish-footer"},H={class:"dish-price"},K={class:"price-text"},Q=["onClick"],W={key:0,class:"cart-badge"},X={key:0,class:"cart-empty"},Y={key:1,class:"cart-items"},ee={class:"item-image"},ae=["src","alt"],le={class:"item-info"},se={class:"item-name"},oe={class:"item-price"},te={class:"item-actions"},ne=["onClick"],ce={class:"quantity"},ie=["onClick"],re={key:2,class:"cart-footer"},ue={class:"total-info"},de={class:"total-price"},ve=e({__name:"index",setup(e){const w=m(),ve=a([]),ge=a([]),me=a([[],[]]),pe=a(""),ye=a("ä¸»é£Ÿ"),fe=a("all"),he=a(null),ke=a([]),we=a(!1),Ce=a(!1),be=a(!1),Se=a([]),qe=a(0),xe=a(!1);let De=null;l(Se,()=>{localStorage.setItem("femaleCart",JSON.stringify(Se.value)),console.log("è´­ç‰©è½¦æ•°æ®å·²ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨")},{deep:!0});const Ie=a([{name:"ä¸»é£Ÿ"},{name:"ç´ èœ"},{name:"è¤èœ"},{name:"å…¶ä»–"}]),Le=a(new Map),$e=e=>{const a=`${e.category} ${e.subCategory} ${e.name}`.toLowerCase();return["æµ·é²œ","é±¼","è™¾","èŸ¹","è´","èº","é²","å‚","è›","è›¤","è›","é±¿","ç« é±¼","å¢¨é±¼","æµ·èœ‡","æµ·å¸¦","ç´«èœ","æµ·è—»"].some(e=>a.includes(e))},_e=()=>{const e=new Map;ve.value.forEach(a=>{let l=a.category,s=a.subCategory;"æ±¤"===l?(l="å…¶ä»–",s="æ±¤"):($e(a)||"æµ·é²œ"===l)&&(l="å…¶ä»–",s="é±¼é²œ"),e.has(l)||e.set(l,new Set),e.get(l).add(s)}),Le.value=e},Oe=async()=>{try{Ce.value=!0,be.value=!1;if(await(async()=>{console.log("======== æ£€æŸ¥é£ä¹¦è¡¨æ ¼æ›´æ–° ========");try{console.log("1. è·å–å½“å‰é£ä¹¦è¡¨æ ¼æ›´æ–°æ—¶é—´...");const e=await C();return e?(console.log("2. å½“å‰é£ä¹¦è¡¨æ ¼æ›´æ–°æ—¶é—´:",e),console.log("3. ä¸Šæ¬¡æ›´æ–°æ—¶é—´:",x),!x||e>x?(console.log("4. æ£€æµ‹åˆ°é£ä¹¦è¡¨æ ¼æ›´æ–°ï¼Œå¼€å§‹é‡æ–°åŠ è½½æ•°æ®..."),await k(),x=e,console.log("5. æ•°æ®é‡æ–°åŠ è½½å®Œæˆï¼Œä¸Šæ¬¡æ›´æ–°æ—¶é—´å·²æ›´æ–°ä¸º:",x),console.log("=============================="),!0):(console.log("4. é£ä¹¦è¡¨æ ¼æœªæ›´æ–°ï¼Œæ£€æŸ¥ç»“æŸ"),console.log("=============================="),!1)):(console.log("2. æ— æ³•è·å–é£ä¹¦è¡¨æ ¼æ›´æ–°æ—¶é—´ï¼Œæ£€æŸ¥ç»“æŸ"),console.log("=============================="),!1)}catch(e){return console.error("æ£€æŸ¥é£ä¹¦è¡¨æ ¼æ›´æ–°å¤±è´¥:",e),console.log("=============================="),!1}})()){console.log("æ£€æµ‹åˆ°é£ä¹¦è¡¨æ ¼æ›´æ–°ï¼Œé‡æ–°åŠ è½½èœå“æ•°æ®...");const e=await D();ve.value=e,_e(),Te(pe.value,ye.value,fe.value),be.value=!0,console.log("èœå“æ•°æ®å·²æ›´æ–°"),setTimeout(()=>{be.value=!1},3e3)}}catch(e){console.error("å¤„ç†æ›´æ–°å¤±è´¥:",e)}finally{Ce.value=!1}},Me=()=>{De&&(console.log("======== åœæ­¢é£ä¹¦è¡¨æ ¼è½®è¯¢ ========"),console.log("åœæ­¢è½®è¯¢å®šæ—¶å™¨ï¼ŒID:",De),clearInterval(De),De=null,console.log("è½®è¯¢å·²åœæ­¢"),console.log("=============================="))};s(()=>{Ue(),Je(),(()=>{const e=localStorage.getItem("femaleCart");e&&(Se.value=JSON.parse(e),Ee(),console.log("ä»æœ¬åœ°å­˜å‚¨åŠ è½½è´­ç‰©è½¦æ•°æ®:",Se.value))})(),console.log("======== å¯åŠ¨é£ä¹¦è¡¨æ ¼è½®è¯¢ ========"),console.log("è½®è¯¢é—´éš”:",30,"ç§’"),Me(),De=setInterval(Oe,3e4),console.log("è½®è¯¢å®šæ—¶å™¨ID:",De),console.log("==============================")}),o(()=>{Me()});const Ue=()=>{const e=[];for(let a=0;a<30;a++)e.push({left:100*Math.random(),top:100*Math.random(),delay:2e3*Math.random(),duration:4e3+2e3*Math.random()});ke.value=e},Je=async()=>{console.log("å¼€å§‹åŠ è½½èœå“æ•°æ®..."),we.value=!0;try{console.log("è°ƒç”¨loadDishDataå‡½æ•°...");const e=await D();console.log("åŠ è½½èœå“æ•°æ®æˆåŠŸï¼Œå…±åŠ è½½åˆ°",e.length,"æ¡æ•°æ®"),ve.value=e,console.log("allDishes.valueèµ‹å€¼å®Œæˆï¼Œé•¿åº¦:",ve.value.length),_e(),console.log("äºŒçº§åˆ†ç±»æ˜ å°„åˆå§‹åŒ–å®Œæˆ"),Te(pe.value,ye.value,fe.value),we.value=!1,console.log("åŠ è½½èœå“æ•°æ®å®Œæˆ")}catch(e){console.error("åŠ è½½èœå“æ•°æ®å¤±è´¥:",e),we.value=!1}},Ne=e=>{fe.value=e,Te(pe.value,ye.value,e),he.value=null},je=e=>{ye.value=e,fe.value="all",Te(pe.value,e,"all")};l(pe,e=>{Te(e,"","all")});const Te=(e,a,l)=>{let s=[...ve.value];if(a&&(s="å…¶ä»–"===a?s.filter(e=>{const a="æ±¤"===e.category,l="æµ·é²œ"===e.category,s=$e(e);return a||l||s}):s.filter(e=>e.category===a),"all"!==l&&("å…¶ä»–"===a?"é±¼é²œ"===l?s=s.filter(e=>"æµ·é²œ"===e.category||$e(e)):"æ±¤"===l&&(s=s.filter(e=>"æ±¤"===e.category)):s=s.filter(e=>e.subCategory===l))),e&&e.trim()){const a=e.toLowerCase();s=ve.value.filter(e=>e.name&&e.name.toLowerCase().includes(a)||e.description&&e.description.toLowerCase().includes(a)||e.ingredients&&e.ingredients.some(e=>e&&e.toLowerCase().includes(a)))}const o=new Map,t=s.filter(e=>{const a=e.name.toLowerCase().replace(/[ç‚–ç…®ç‚’ç‚¸çƒ§ç„–ç…çƒ¤è’¸çƒ©æ‹Œ]/g," ").split("").sort().join("");return!o.has(a)&&(o.set(a,e),!0)});ge.value=t,console.log("æœç´¢å…³é”®è¯:",e,"åŸæ•°æ®é•¿åº¦:",s.length,"å»é‡åé•¿åº¦:",t.length),(e=>{const a=[[],[]];e.forEach((e,l)=>{a[l%2].push(e)}),me.value=a})(t)},Ee=()=>{qe.value=Se.value.reduce((e,a)=>e+a.quantity,0)},Ae=()=>{xe.value=!xe.value,console.log("è´­ç‰©è½¦é¢æ¿çŠ¶æ€:",xe.value)},Re=(e,a)=>{const l=e.quantity+a;if(l<=0){const a=Se.value.findIndex(a=>a.id===e.id);a>-1&&Se.value.splice(a,1)}else e.quantity=l;Ee(),console.log("æ›´æ–°å•†å“æ•°é‡:",e.name,"æ–°æ•°é‡:",l)},ze=async()=>{if(0===qe.value)return void console.log("è´­ç‰©è½¦ä¸ºç©ºï¼Œæ— æ³•ä¸‹å•");const e={id:"ORD"+Date.now().toString().slice(-8),createTime:Date.now(),status:"completed",statusText:"å·²å®Œæˆ",items:Se.value.map(e=>({id:e.id,name:e.name,price:e.price,quantity:e.quantity})),totalItems:qe.value,totalPrice:`${qe.value}ä¸ªäº²äº²`};console.log("ç”Ÿæˆè®¢å•:",e);const a=localStorage.getItem("femaleOrders");let l=[];a&&(l=JSON.parse(a)),l.unshift(e),localStorage.setItem("femaleOrders",JSON.stringify(l)),console.log("è®¢å•å·²ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨:",e);for(const o of Se.value)for(let e=0;e<o.quantity;e++)try{await b({name:o.name,createTime:(new Date).toLocaleString("zh-CN",{timeZone:"Asia/Shanghai"}),status:"pending"}),console.log(`å·²å‘é£ä¹¦è¡¨æ ¼æ·»åŠ è®°å½•: ${o.name}`)}catch(s){console.error("å‘é£ä¹¦è¡¨æ ¼æ·»åŠ è®°å½•å¤±è´¥:",s)}Se.value=[],Ee(),xe.value=!1,w.push("/royal-seal"),console.log("ä¸‹å•æˆåŠŸï¼Œå·²è·³è½¬åˆ°å†å²è®¢å•é¡µé¢")};return(e,a)=>{return p(),t("div",I,[n("div",L,[(p(!0),t(i,null,r(ke.value,(e,a)=>(p(),t("div",{key:a,class:"particle",style:y({left:`${e.left}%`,top:`${e.top}%`,animationDelay:`${e.delay}ms`,animationDuration:`${e.duration}ms`})},null,4))),128))]),be.value?(p(),t("div",$," æ•°æ®å·²æ›´æ–°ï¼Œå±•ç¤ºæœ€æ–°èœè‚´ï¼ ")):c("",!0),Ce.value?(p(),t("div",_," æ£€æŸ¥æ›´æ–°ä¸­... ")):c("",!0),a[9]||(a[9]=n("div",{class:"custom-navbar"},[n("div",{class:"nav-right"})],-1)),n("div",O,[n("div",M,[n("div",U,[a[2]||(a[2]=n("img",{class:"search-icon",src:S,alt:"æœç´¢å›¾æ ‡"},null,-1)),u(n("input",{type:"text",placeholder:"æœç´¢èœå“",class:"search-placeholder","onUpdate:modelValue":a[0]||(a[0]=e=>pe.value=e)},null,512),[[d,pe.value]])])]),n("div",J,[n("div",N,[(p(!0),t(i,null,r(Ie.value,e=>(p(),t("div",{key:e.name,class:v(["category-item",{selected:ye.value===e.name}]),onClick:a=>(e=>{he.value===e?he.value=null:(he.value=e,fe.value="all",je(e))})(e.name)},[n("span",T,g(e.name),1),n("span",{class:v(["dropdown-arrow",{rotated:he.value===e.name}])},"â–¼",2)],10,j))),128))]),he.value?(p(),t("div",E,[n("div",{class:v(["subcategory-item",{selected:"all"===fe.value}]),onClick:a[1]||(a[1]=e=>Ne("all"))},[...a[3]||(a[3]=[n("span",{class:"subcategory-text"},"å…¨éƒ¨",-1)])],2),(p(!0),t(i,null,r((l=he.value,Array.from(Le.value.get(l)||[])),e=>(p(),t("div",{key:e,class:v(["subcategory-item",{selected:fe.value===e}]),onClick:a=>Ne(e)},[n("span",R,g(e),1)],10,A))),128))])):c("",!0)]),n("div",z,[(p(!0),t(i,null,r(me.value,(e,l)=>(p(),t("div",{class:"waterfall-column",key:l},[(p(!0),t(i,null,r(e,e=>(p(),t("div",{class:"dish-card",key:e.id},[a[6]||(a[6]=n("div",{class:"card-background"},null,-1)),n("div",B,[n("img",{class:"dish-image",src:e.imageUrl,alt:"dish.name",onError:a=>((e,a)=>{console.error(`å›¾ç‰‡åŠ è½½å¤±è´¥: ${JSON.stringify(a.imageUrl)}`),e.target.src=`https://picsum.photos/200/200?random=${a.id}`,a.imageUrl=e.target.src})(a,e)},null,40,F),n("div",P,[n("span",V,g(e.name),1),n("span",Z,g(e.description),1),n("div",G,[n("div",H,[a[4]||(a[4]=n("img",{class:"price-icon",src:h,alt:"é©¬å¡é¾™é»„è‰²"},null,-1)),n("span",K,g(e.price),1)]),n("div",{class:"add-to-cart-btn",onClick:f(a=>(e=>{const a=Se.value.find(a=>a.id===e.id);a?a.quantity+=1:Se.value.push({...e,quantity:1}),Ee(),console.log("æ·»åŠ åˆ°è´­ç‰©è½¦æˆåŠŸ:",e.name,"è´­ç‰©è½¦æ•°é‡:",qe.value)})(e),["stop"])},[...a[5]||(a[5]=[n("img",{class:"add-icon",src:q,alt:"æ·»åŠ åˆ°è´­ç‰©è½¦"},null,-1)])],8,Q)])])])]))),128))]))),128))])]),n("div",{class:"fab",onClick:Ae},[qe.value>0?(p(),t("div",W,g(qe.value),1)):c("",!0)]),n("div",{class:v(["cart-panel",{expanded:xe.value}])},[n("div",{class:"cart-header"},[a[7]||(a[7]=n("h3",null,"æˆ‘çš„è´­ç‰©è½¦",-1)),n("span",{class:"close-btn",onClick:Ae},"Ã—")]),0===qe.value?(p(),t("div",X,[...a[8]||(a[8]=[n("span",{class:"empty-icon"},"ğŸ›’",-1),n("p",null,"è´­ç‰©è½¦æ˜¯ç©ºçš„ï¼Œå¿«å»æ·»åŠ ç¾é£Ÿå§ï½",-1)])])):(p(),t("div",Y,[(p(!0),t(i,null,r(Se.value,e=>(p(),t("div",{key:e.id,class:"cart-item"},[n("div",ee,[n("img",{src:e.imageUrl,alt:e.name},null,8,ae)]),n("div",le,[n("h4",se,g(e.name),1),n("p",oe,g(e.price),1)]),n("div",te,[n("button",{class:"action-btn decrease",onClick:a=>Re(e,-1)},"-",8,ne),n("span",ce,g(e.quantity),1),n("button",{class:"action-btn increase",onClick:a=>Re(e,1)},"+",8,ie)])]))),128))])),qe.value>0?(p(),t("div",re,[n("div",ue,[n("span",null,"å…± "+g(qe.value)+" ä»¶å•†å“",1),n("span",de,"æ€»è®¡ï¼š"+g(qe.value)+" ä¸ªäº²äº²",1)]),n("button",{class:"checkout-btn",onClick:ze},"ä¸‹å•")])):c("",!0)],2)]);var l}}},[["__scopeId","data-v-209f3c98"]]);export{ve as default};
